"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.connectSendTextBox = exports.default = void 0;

var _glamor = require("glamor");

var _classnames = _interopRequireDefault(require("classnames"));

var _react = _interopRequireDefault(require("react"));

var _TypeFocusSink = require("../Utils/TypeFocusSink");

var _Localize = require("../Localization/Localize");

var _connectToWebChat = _interopRequireDefault(require("../connectToWebChat"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var ROOT_CSS = (0, _glamor.css)({
  display: 'flex',
  '& > input': {
    flex: 1
  }
});

var connectSendTextBox = function connectSendTextBox() {
  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {
    selectors[_key] = arguments[_key];
  }

  return _connectToWebChat.default.apply(void 0, [function (_ref) {
    var disabled = _ref.disabled,
        language = _ref.language,
        scrollToEnd = _ref.scrollToEnd,
        sendBoxValue = _ref.sendBoxValue,
        setSendBox = _ref.setSendBox,
        submitSendBox = _ref.submitSendBox;
    return {
      disabled: disabled,
      language: language,
      onChange: function onChange(_ref2) {
        var value = _ref2.target.value;
        setSendBox(value);
      },
      onSubmit: function onSubmit(event) {
        event.preventDefault(); // Consider clearing the send box only after we received POST_ACTIVITY_PENDING
        // E.g. if the connection is bad, sending the message essentially do nothing but just clearing the send box

        if (sendBoxValue) {
          scrollToEnd();
          submitSendBox();
        }
      },
      value: sendBoxValue
    };
  }].concat(selectors));
};

exports.connectSendTextBox = connectSendTextBox;

var _default = connectSendTextBox(function (_ref3) {
  var styleSet = _ref3.styleSet;
  return {
    styleSet: styleSet
  };
})(function (_ref4) {
  var className = _ref4.className,
      disabled = _ref4.disabled,
      language = _ref4.language,
      onChange = _ref4.onChange,
      onSubmit = _ref4.onSubmit,
      styleSet = _ref4.styleSet,
      value = _ref4.value;
  var typeYourMessageString = (0, _Localize.localize)('Type your message', language);
  return _react.default.createElement("form", {
    className: (0, _classnames.default)(ROOT_CSS + '', styleSet.sendBoxTextBox + '', (className || '') + ''),
    onSubmit: onSubmit
  }, _react.default.createElement(_TypeFocusSink.Context.Consumer, null, function (_ref5) {
    var sendFocusRef = _ref5.sendFocusRef;
    return _react.default.createElement("input", {
      "aria-label": typeYourMessageString,
      "data-id": "webchat-sendbox-input",
      disabled: disabled,
      onChange: onChange,
      placeholder: typeYourMessageString,
      ref: sendFocusRef,
      type: "text",
      value: value
    });
  }));
});

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TZW5kQm94L1RleHRCb3guanMiXSwibmFtZXMiOlsiUk9PVF9DU1MiLCJkaXNwbGF5IiwiZmxleCIsImNvbm5lY3RTZW5kVGV4dEJveCIsInNlbGVjdG9ycyIsImNvbm5lY3RUb1dlYkNoYXQiLCJkaXNhYmxlZCIsImxhbmd1YWdlIiwic2Nyb2xsVG9FbmQiLCJzZW5kQm94VmFsdWUiLCJzZXRTZW5kQm94Iiwic3VibWl0U2VuZEJveCIsIm9uQ2hhbmdlIiwidmFsdWUiLCJ0YXJnZXQiLCJvblN1Ym1pdCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJzdHlsZVNldCIsImNsYXNzTmFtZSIsInR5cGVZb3VyTWVzc2FnZVN0cmluZyIsInNlbmRCb3hUZXh0Qm94Iiwic2VuZEZvY3VzUmVmIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7Ozs7QUFFQSxJQUFNQSxRQUFRLEdBQUcsaUJBQUk7QUFDbkJDLEVBQUFBLE9BQU8sRUFBRSxNQURVO0FBR25CLGVBQWE7QUFDWEMsSUFBQUEsSUFBSSxFQUFFO0FBREs7QUFITSxDQUFKLENBQWpCOztBQVFBLElBQU1DLGtCQUFrQixHQUFHLFNBQXJCQSxrQkFBcUI7QUFBQSxvQ0FBSUMsU0FBSjtBQUFJQSxJQUFBQSxTQUFKO0FBQUE7O0FBQUEsU0FBa0JDLHlDQUMzQztBQUFBLFFBQ0VDLFFBREYsUUFDRUEsUUFERjtBQUFBLFFBRUVDLFFBRkYsUUFFRUEsUUFGRjtBQUFBLFFBR0VDLFdBSEYsUUFHRUEsV0FIRjtBQUFBLFFBSUVDLFlBSkYsUUFJRUEsWUFKRjtBQUFBLFFBS0VDLFVBTEYsUUFLRUEsVUFMRjtBQUFBLFFBTUVDLGFBTkYsUUFNRUEsYUFORjtBQUFBLFdBT087QUFDTEwsTUFBQUEsUUFBUSxFQUFSQSxRQURLO0FBRUxDLE1BQUFBLFFBQVEsRUFBUkEsUUFGSztBQUdMSyxNQUFBQSxRQUFRLEVBQUUseUJBQTJCO0FBQUEsWUFBZEMsS0FBYyxTQUF4QkMsTUFBd0IsQ0FBZEQsS0FBYztBQUNuQ0gsUUFBQUEsVUFBVSxDQUFDRyxLQUFELENBQVY7QUFDRCxPQUxJO0FBTUxFLE1BQUFBLFFBQVEsRUFBRSxrQkFBQUMsS0FBSyxFQUFJO0FBQ2pCQSxRQUFBQSxLQUFLLENBQUNDLGNBQU4sR0FEaUIsQ0FHakI7QUFDQTs7QUFFQSxZQUFJUixZQUFKLEVBQWtCO0FBQ2hCRCxVQUFBQSxXQUFXO0FBQ1hHLFVBQUFBLGFBQWE7QUFDZDtBQUNGLE9BaEJJO0FBaUJMRSxNQUFBQSxLQUFLLEVBQUVKO0FBakJGLEtBUFA7QUFBQSxHQUQyQyxTQTJCeENMLFNBM0J3QyxFQUFsQjtBQUFBLENBQTNCOzs7O2VBOEJlRCxrQkFBa0IsQ0FDL0I7QUFBQSxNQUFHZSxRQUFILFNBQUdBLFFBQUg7QUFBQSxTQUFtQjtBQUFFQSxJQUFBQSxRQUFRLEVBQVJBO0FBQUYsR0FBbkI7QUFBQSxDQUQrQixDQUFsQixDQUViLGlCQVFJO0FBQUEsTUFQSkMsU0FPSSxTQVBKQSxTQU9JO0FBQUEsTUFOSmIsUUFNSSxTQU5KQSxRQU1JO0FBQUEsTUFMSkMsUUFLSSxTQUxKQSxRQUtJO0FBQUEsTUFKSkssUUFJSSxTQUpKQSxRQUlJO0FBQUEsTUFISkcsUUFHSSxTQUhKQSxRQUdJO0FBQUEsTUFGSkcsUUFFSSxTQUZKQSxRQUVJO0FBQUEsTUFESkwsS0FDSSxTQURKQSxLQUNJO0FBQ0osTUFBTU8scUJBQXFCLEdBQUcsd0JBQVMsbUJBQVQsRUFBOEJiLFFBQTlCLENBQTlCO0FBRUEsU0FDRTtBQUNFLElBQUEsU0FBUyxFQUFHLHlCQUNWUCxRQUFRLEdBQUcsRUFERCxFQUVWa0IsUUFBUSxDQUFDRyxjQUFULEdBQTBCLEVBRmhCLEVBR1YsQ0FBQ0YsU0FBUyxJQUFJLEVBQWQsSUFBb0IsRUFIVixDQURkO0FBTUUsSUFBQSxRQUFRLEVBQUdKO0FBTmIsS0FTSSw2QkFBQyxzQkFBRCxDQUFzQixRQUF0QixRQUNJO0FBQUEsUUFBR08sWUFBSCxTQUFHQSxZQUFIO0FBQUEsV0FDQTtBQUNFLG9CQUFhRixxQkFEZjtBQUVFLGlCQUFRLHVCQUZWO0FBR0UsTUFBQSxRQUFRLEVBQUdkLFFBSGI7QUFJRSxNQUFBLFFBQVEsRUFBR00sUUFKYjtBQUtFLE1BQUEsV0FBVyxFQUFHUSxxQkFMaEI7QUFNRSxNQUFBLEdBQUcsRUFBR0UsWUFOUjtBQU9FLE1BQUEsSUFBSSxFQUFDLE1BUFA7QUFRRSxNQUFBLEtBQUssRUFBR1Q7QUFSVixNQURBO0FBQUEsR0FESixDQVRKLENBREY7QUEyQkQsQ0F4Q2MsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNzcyB9IGZyb20gJ2dsYW1vcic7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCB7IENvbnRleHQgYXMgVHlwZUZvY3VzU2lua0NvbnRleHQgfSBmcm9tICcuLi9VdGlscy9UeXBlRm9jdXNTaW5rJztcbmltcG9ydCB7IGxvY2FsaXplIH0gZnJvbSAnLi4vTG9jYWxpemF0aW9uL0xvY2FsaXplJztcbmltcG9ydCBjb25uZWN0VG9XZWJDaGF0IGZyb20gJy4uL2Nvbm5lY3RUb1dlYkNoYXQnO1xuXG5jb25zdCBST09UX0NTUyA9IGNzcyh7XG4gIGRpc3BsYXk6ICdmbGV4JyxcblxuICAnJiA+IGlucHV0Jzoge1xuICAgIGZsZXg6IDFcbiAgfVxufSk7XG5cbmNvbnN0IGNvbm5lY3RTZW5kVGV4dEJveCA9ICguLi5zZWxlY3RvcnMpID0+IGNvbm5lY3RUb1dlYkNoYXQoXG4gICh7XG4gICAgZGlzYWJsZWQsXG4gICAgbGFuZ3VhZ2UsXG4gICAgc2Nyb2xsVG9FbmQsXG4gICAgc2VuZEJveFZhbHVlLFxuICAgIHNldFNlbmRCb3gsXG4gICAgc3VibWl0U2VuZEJveFxuICB9KSA9PiAoe1xuICAgIGRpc2FibGVkLFxuICAgIGxhbmd1YWdlLFxuICAgIG9uQ2hhbmdlOiAoeyB0YXJnZXQ6IHsgdmFsdWUgfSB9KSA9PiB7XG4gICAgICBzZXRTZW5kQm94KHZhbHVlKTtcbiAgICB9LFxuICAgIG9uU3VibWl0OiBldmVudCA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAvLyBDb25zaWRlciBjbGVhcmluZyB0aGUgc2VuZCBib3ggb25seSBhZnRlciB3ZSByZWNlaXZlZCBQT1NUX0FDVElWSVRZX1BFTkRJTkdcbiAgICAgIC8vIEUuZy4gaWYgdGhlIGNvbm5lY3Rpb24gaXMgYmFkLCBzZW5kaW5nIHRoZSBtZXNzYWdlIGVzc2VudGlhbGx5IGRvIG5vdGhpbmcgYnV0IGp1c3QgY2xlYXJpbmcgdGhlIHNlbmQgYm94XG5cbiAgICAgIGlmIChzZW5kQm94VmFsdWUpIHtcbiAgICAgICAgc2Nyb2xsVG9FbmQoKTtcbiAgICAgICAgc3VibWl0U2VuZEJveCgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWU6IHNlbmRCb3hWYWx1ZVxuICB9KSxcbiAgLi4uc2VsZWN0b3JzXG4pXG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3RTZW5kVGV4dEJveChcbiAgKHsgc3R5bGVTZXQgfSkgPT4gKHsgc3R5bGVTZXQgfSlcbikoKHtcbiAgY2xhc3NOYW1lLFxuICBkaXNhYmxlZCxcbiAgbGFuZ3VhZ2UsXG4gIG9uQ2hhbmdlLFxuICBvblN1Ym1pdCxcbiAgc3R5bGVTZXQsXG4gIHZhbHVlXG59KSA9PiB7XG4gIGNvbnN0IHR5cGVZb3VyTWVzc2FnZVN0cmluZyA9IGxvY2FsaXplKCdUeXBlIHlvdXIgbWVzc2FnZScsIGxhbmd1YWdlKTtcblxuICByZXR1cm4gKFxuICAgIDxmb3JtXG4gICAgICBjbGFzc05hbWU9eyBjbGFzc05hbWVzKFxuICAgICAgICBST09UX0NTUyArICcnLFxuICAgICAgICBzdHlsZVNldC5zZW5kQm94VGV4dEJveCArICcnLFxuICAgICAgICAoY2xhc3NOYW1lIHx8ICcnKSArICcnLFxuICAgICAgKSB9XG4gICAgICBvblN1Ym1pdD17IG9uU3VibWl0IH1cbiAgICA+XG4gICAgICB7XG4gICAgICAgIDxUeXBlRm9jdXNTaW5rQ29udGV4dC5Db25zdW1lcj5cbiAgICAgICAgICB7ICh7IHNlbmRGb2N1c1JlZiB9KSA9PlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9eyB0eXBlWW91ck1lc3NhZ2VTdHJpbmcgfVxuICAgICAgICAgICAgICBkYXRhLWlkPVwid2ViY2hhdC1zZW5kYm94LWlucHV0XCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyBkaXNhYmxlZCB9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsgb25DaGFuZ2UgfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17IHR5cGVZb3VyTWVzc2FnZVN0cmluZyB9XG4gICAgICAgICAgICAgIHJlZj17IHNlbmRGb2N1c1JlZiB9XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgdmFsdWU9eyB2YWx1ZSB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIH1cbiAgICAgICAgPC9UeXBlRm9jdXNTaW5rQ29udGV4dC5Db25zdW1lcj5cbiAgICAgIH1cbiAgICA8L2Zvcm0+XG4gICk7XG59KVxuXG5leHBvcnQgeyBjb25uZWN0U2VuZFRleHRCb3ggfVxuIl19